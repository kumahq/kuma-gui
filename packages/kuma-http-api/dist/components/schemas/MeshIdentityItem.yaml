description: 'MeshIdentity manages service identity and certificate provisioning for workloads in the mesh. It configures how services obtain their identity certificates, supporting multiple providers including bundled certificates (self-signed or user-provided CA), SPIRE integration, and custom SPIFFE ID configuration for secure service-to-service authentication.'
type: object
properties:
  type:
    description: the type of the resource
    type: string
    enum:
      - MeshIdentity
  mesh:
    description: Mesh is the name of the Kuma mesh this resource belongs to. It may be omitted for cluster-scoped resources.
    type: string
    default: default
  kri:
    description: A unique identifier for this resource instance used by internal tooling and integrations. Typically derived from resource attributes and may be used for cross-references or indexing
    type: string
    example: kri_mid_default_zone-east_kuma-system_myresource1_
    readOnly: true
  name:
    description: Name of the Kuma resource
    type: string
  labels:
    description: The labels to help identity resources
    type: object
    additionalProperties:
      type: string
  spec:
    description: Spec is the specification of the Kuma MeshIdentity resource.
    type: object
    properties:
      provider:
        type: object
        properties:
          bundled:
            description: |-
              Bundled provides information about certificates that are generated by the control plane,
              either autogenerated or provided by the user.
            type: object
            properties:
              autogenerate:
                description: Autogenerate configures the control plane to use self-signed certificates.
                type: object
                properties:
                  enabled:
                    type: boolean
              ca:
                description: CA has configuration related to the CA
                type: object
                properties:
                  certificate:
                    description: Certificate allows the user to specify a custom certificate.
                    type: object
                    properties:
                      envVar:
                        type: object
                        properties:
                          name:
                            type: string
                        required:
                          - name
                      file:
                        type: object
                        properties:
                          path:
                            type: string
                        required:
                          - path
                      insecureInline:
                        type: object
                        properties:
                          value:
                            type: string
                        required:
                          - value
                      secretRef:
                        type: object
                        properties:
                          kind:
                            type: string
                            enum:
                              - Secret
                          name:
                            type: string
                        required:
                          - kind
                          - name
                      type:
                        type: string
                        enum:
                          - File
                          - Secret
                          - EnvVar
                          - InsecureInline
                    required:
                      - type
                  privateKey:
                    description: PrivateKey allows the user to specify a custom private key.
                    type: object
                    properties:
                      envVar:
                        type: object
                        properties:
                          name:
                            type: string
                        required:
                          - name
                      file:
                        type: object
                        properties:
                          path:
                            type: string
                        required:
                          - path
                      insecureInline:
                        type: object
                        properties:
                          value:
                            type: string
                        required:
                          - value
                      secretRef:
                        type: object
                        properties:
                          kind:
                            type: string
                            enum:
                              - Secret
                          name:
                            type: string
                        required:
                          - kind
                          - name
                      type:
                        type: string
                        enum:
                          - File
                          - Secret
                          - EnvVar
                          - InsecureInline
                    required:
                      - type
              certificateParameters:
                description: CertificateParameters allows users to define certificate generation parameters.
                type: object
                properties:
                  expiry:
                    type: string
              insecureAllowSelfSigned:
                description: InsecureAllowSelfSigned allows users to enable the use of self-signed certificates.
                type: boolean
              meshTrustCreation:
                description: |-
                  MeshTrustCreation defines whether a MeshTrust resource should be automatically created
                  from an existing MeshIdentity. If not defined, the control plane automatically generates a MeshTrust.
                type: string
                enum:
                  - Enabled
                  - Disabled
          spire:
            description: Spire indicates that SPIRE is used for certificate delivery.
            type: object
            properties:
              agent:
                description: Spire agent configuration
                type: object
                properties:
                  timeout:
                    description: |-
                      Connection timeout to the socket exposed by Spire agent
                      Default 1 second.
                    type: string
          type:
            description: Type specifies the type of certificate provider.
            type: string
            enum:
              - Bundled
              - Spire
        required:
          - type
      selector:
        type: object
        properties:
          dataplane:
            type: object
            properties:
              matchLabels:
                type: object
                additionalProperties:
                  type: string
      spiffeID:
        type: object
        properties:
          path:
            type: string
          trustDomain:
            type: string
  creationTime:
    description: Time at which the resource was created
    type: string
    format: date-time
    example: '0001-01-01T00:00:00Z'
    readOnly: true
  modificationTime:
    description: Time at which the resource was updated
    type: string
    format: date-time
    example: '0001-01-01T00:00:00Z'
    readOnly: true
  status:
    description: Status is the current status of the Kuma MeshIdentity resource.
    type: object
    properties:
      conditions:
        description: Conditions is an array of hostname generator conditions.
        type: array
        items:
          properties:
            message:
              description: |-
                message is a human readable message indicating details about the transition.
                This may be an empty string.
              type: string
              maxLength: 32768
            reason:
              description: |-
                reason contains a programmatic identifier indicating the reason for the condition's last transition.
                Producers of specific condition types may define expected values and meanings for this field,
                and whether the values are considered a guaranteed API.
                The value should be a CamelCase string.
                This field may not be empty.
              type: string
              maxLength: 1024
              minLength: 1
              pattern: '^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$'
            status:
              description: 'status of the condition, one of True, False, Unknown.'
              type: string
              enum:
                - 'True'
                - 'False'
                - Unknown
            type:
              description: type of condition in CamelCase or in foo.example.com/CamelCase.
              type: string
              maxLength: 316
              pattern: '^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$'
          required:
            - message
            - reason
            - status
            - type
          type: object
        x-kubernetes-list-map-keys:
          - type
        x-kubernetes-list-type: map
    readOnly: true
required:
  - type
  - name
  - spec
