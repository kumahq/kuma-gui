description: MeshFaultInjection allows you to test the resiliency of your services by injecting faults like delays, connection aborts, and response bandwidth limits into the traffic. This is useful for chaos testing and validating that your applications handle failures gracefully.
type: object
properties:
  type:
    description: the type of the resource
    type: string
    enum:
      - MeshFaultInjection
  mesh:
    description: Mesh is the name of the Kuma mesh this resource belongs to. It may be omitted for cluster-scoped resources.
    type: string
    default: default
  kri:
    description: A unique identifier for this resource instance used by internal tooling and integrations. Typically derived from resource attributes and may be used for cross-references or indexing
    type: string
    example: kri_mfi_default_zone-east_kuma-demo_mypolicy1_
    readOnly: true
  name:
    description: Name of the Kuma resource
    type: string
  labels:
    description: The labels to help identity resources
    type: object
    additionalProperties:
      type: string
  spec:
    description: Spec is the specification of the Kuma MeshFaultInjection resource.
    type: object
    properties:
      from:
        description: From list makes a match between clients and corresponding configurations
        type: array
        items:
          properties:
            default:
              description: |-
                Default is a configuration specific to the group of destinations referenced in
                'targetRef'
              type: object
              properties:
                http:
                  description: Http allows to define list of Http faults between dataplanes.
                  type: array
                  items:
                    description: FaultInjection defines the configuration of faults between dataplanes.
                    properties:
                      abort:
                        description: |-
                          Abort defines a configuration of not delivering requests to destination
                          service and replacing the responses from destination dataplane by
                          predefined status code
                        type: object
                        properties:
                          httpStatus:
                            description: HTTP status code which will be returned to source side
                            type: integer
                            format: int32
                          percentage:
                            description: |-
                              Percentage of requests on which abort will be injected, has to be
                              either int or decimal represented as string.
                            anyOf:
                              - type: integer
                              - type: string
                            x-kubernetes-int-or-string: true
                        required:
                          - httpStatus
                          - percentage
                      delay:
                        description: Delay defines configuration of delaying a response from a destination
                        type: object
                        properties:
                          percentage:
                            description: |-
                              Percentage of requests on which delay will be injected, has to be
                              either int or decimal represented as string.
                            anyOf:
                              - type: integer
                              - type: string
                            x-kubernetes-int-or-string: true
                          value:
                            description: The duration during which the response will be delayed
                            type: string
                        required:
                          - percentage
                          - value
                      responseBandwidth:
                        description: |-
                          ResponseBandwidth defines a configuration to limit the speed of
                          responding to the requests
                        type: object
                        properties:
                          limit:
                            description: |-
                              Limit is represented by value measure in Gbps, Mbps, kbps, e.g.
                              10kbps
                            type: string
                          percentage:
                            description: |-
                              Percentage of requests on which response bandwidth limit will be
                              either int or decimal represented as string.
                            anyOf:
                              - type: integer
                              - type: string
                            x-kubernetes-int-or-string: true
                        required:
                          - limit
                          - percentage
                    type: object
            targetRef:
              description: |-
                TargetRef is a reference to the resource that represents a group of
                destinations.
              type: object
              properties:
                kind:
                  description: Kind of the referenced resource
                  type: string
                  enum:
                    - Mesh
                    - MeshSubset
                    - MeshGateway
                    - MeshService
                    - MeshExternalService
                    - MeshMultiZoneService
                    - MeshServiceSubset
                    - MeshHTTPRoute
                    - Dataplane
                labels:
                  description: |-
                    Labels are used to select group of MeshServices that match labels. Either Labels or
                    Name and Namespace can be used.
                  type: object
                  additionalProperties:
                    type: string
                mesh:
                  description: Mesh is reserved for future use to identify cross mesh resources.
                  type: string
                name:
                  description: |-
                    Name of the referenced resource. Can only be used with kinds: `MeshService`,
                    `MeshServiceSubset` and `MeshGatewayRoute`
                  type: string
                namespace:
                  description: |-
                    Namespace specifies the namespace of target resource. If empty only resources in policy namespace
                    will be targeted.
                  type: string
                proxyTypes:
                  description: |-
                    ProxyTypes specifies the data plane types that are subject to the policy. When not specified,
                    all data plane types are targeted by the policy.
                  type: array
                  items:
                    enum:
                      - Sidecar
                      - Gateway
                    type: string
                sectionName:
                  description: |-
                    SectionName is used to target specific section of resource.
                    For example, you can target port from MeshService.ports[] by its name. Only traffic to this port will be affected.
                  type: string
                tags:
                  description: |-
                    Tags used to select a subset of proxies by tags. Can only be used with kinds
                    `MeshSubset` and `MeshServiceSubset`
                  type: object
                  additionalProperties:
                    type: string
              required:
                - kind
          required:
            - targetRef
          type: object
      rules:
        description: Rules defines inbound fault injection configuration
        type: array
        items:
          properties:
            default:
              description: Default defines fault configuration
              type: object
              properties:
                http:
                  description: Http allows to define list of Http faults between dataplanes.
                  type: array
                  items:
                    description: FaultInjection defines the configuration of faults between dataplanes.
                    properties:
                      abort:
                        description: |-
                          Abort defines a configuration of not delivering requests to destination
                          service and replacing the responses from destination dataplane by
                          predefined status code
                        type: object
                        properties:
                          httpStatus:
                            description: HTTP status code which will be returned to source side
                            type: integer
                            format: int32
                          percentage:
                            description: |-
                              Percentage of requests on which abort will be injected, has to be
                              either int or decimal represented as string.
                            anyOf:
                              - type: integer
                              - type: string
                            x-kubernetes-int-or-string: true
                        required:
                          - httpStatus
                          - percentage
                      delay:
                        description: Delay defines configuration of delaying a response from a destination
                        type: object
                        properties:
                          percentage:
                            description: |-
                              Percentage of requests on which delay will be injected, has to be
                              either int or decimal represented as string.
                            anyOf:
                              - type: integer
                              - type: string
                            x-kubernetes-int-or-string: true
                          value:
                            description: The duration during which the response will be delayed
                            type: string
                        required:
                          - percentage
                          - value
                      responseBandwidth:
                        description: |-
                          ResponseBandwidth defines a configuration to limit the speed of
                          responding to the requests
                        type: object
                        properties:
                          limit:
                            description: |-
                              Limit is represented by value measure in Gbps, Mbps, kbps, e.g.
                              10kbps
                            type: string
                          percentage:
                            description: |-
                              Percentage of requests on which response bandwidth limit will be
                              either int or decimal represented as string.
                            anyOf:
                              - type: integer
                              - type: string
                            x-kubernetes-int-or-string: true
                        required:
                          - limit
                          - percentage
                    type: object
            matches:
              description: Matches defines list of matches for which fault injection will be applied
              type: array
              items:
                properties:
                  spiffeID:
                    description: SpiffeID defines a matcher configuration for SpiffeID matching
                    type: object
                    properties:
                      type:
                        description: Type defines how to match incoming traffic by SpiffeID. `Exact` or `Prefix` are allowed.
                        type: string
                        enum:
                          - Exact
                          - Prefix
                      value:
                        description: Value is SpiffeId of a client that needs to match for the configuration to be applied
                        type: string
                    required:
                      - type
                      - value
                type: object
          required:
            - default
          type: object
          default:
            targetRef:
              kind: MeshService
            default:
              http: []
      targetRef:
        description: |-
          TargetRef is a reference to the resource the policy takes an effect on.
          The resource could be either a real store object or virtual resource
          defined inplace.
        type: object
        properties:
          kind:
            description: Kind of the referenced resource
            type: string
            enum:
              - Mesh
              - MeshSubset
              - MeshGateway
              - MeshService
              - MeshExternalService
              - MeshMultiZoneService
              - MeshServiceSubset
              - MeshHTTPRoute
              - Dataplane
          labels:
            description: |-
              Labels are used to select group of MeshServices that match labels. Either Labels or
              Name and Namespace can be used.
            type: object
            additionalProperties:
              type: string
          mesh:
            description: Mesh is reserved for future use to identify cross mesh resources.
            type: string
          name:
            description: |-
              Name of the referenced resource. Can only be used with kinds: `MeshService`,
              `MeshServiceSubset` and `MeshGatewayRoute`
            type: string
          namespace:
            description: |-
              Namespace specifies the namespace of target resource. If empty only resources in policy namespace
              will be targeted.
            type: string
          proxyTypes:
            description: |-
              ProxyTypes specifies the data plane types that are subject to the policy. When not specified,
              all data plane types are targeted by the policy.
            type: array
            items:
              enum:
                - Sidecar
                - Gateway
              type: string
          sectionName:
            description: |-
              SectionName is used to target specific section of resource.
              For example, you can target port from MeshService.ports[] by its name. Only traffic to this port will be affected.
            type: string
          tags:
            description: |-
              Tags used to select a subset of proxies by tags. Can only be used with kinds
              `MeshSubset` and `MeshServiceSubset`
            type: object
            additionalProperties:
              type: string
        required:
          - kind
      to:
        description: To list makes a match between clients and corresponding configurations
        type: array
        items:
          properties:
            default:
              description: |-
                Default is a configuration specific to the group of destinations referenced in
                'targetRef'
              type: object
              properties:
                http:
                  description: Http allows to define list of Http faults between dataplanes.
                  type: array
                  items:
                    description: FaultInjection defines the configuration of faults between dataplanes.
                    properties:
                      abort:
                        description: |-
                          Abort defines a configuration of not delivering requests to destination
                          service and replacing the responses from destination dataplane by
                          predefined status code
                        type: object
                        properties:
                          httpStatus:
                            description: HTTP status code which will be returned to source side
                            type: integer
                            format: int32
                          percentage:
                            description: |-
                              Percentage of requests on which abort will be injected, has to be
                              either int or decimal represented as string.
                            anyOf:
                              - type: integer
                              - type: string
                            x-kubernetes-int-or-string: true
                        required:
                          - httpStatus
                          - percentage
                      delay:
                        description: Delay defines configuration of delaying a response from a destination
                        type: object
                        properties:
                          percentage:
                            description: |-
                              Percentage of requests on which delay will be injected, has to be
                              either int or decimal represented as string.
                            anyOf:
                              - type: integer
                              - type: string
                            x-kubernetes-int-or-string: true
                          value:
                            description: The duration during which the response will be delayed
                            type: string
                        required:
                          - percentage
                          - value
                      responseBandwidth:
                        description: |-
                          ResponseBandwidth defines a configuration to limit the speed of
                          responding to the requests
                        type: object
                        properties:
                          limit:
                            description: |-
                              Limit is represented by value measure in Gbps, Mbps, kbps, e.g.
                              10kbps
                            type: string
                          percentage:
                            description: |-
                              Percentage of requests on which response bandwidth limit will be
                              either int or decimal represented as string.
                            anyOf:
                              - type: integer
                              - type: string
                            x-kubernetes-int-or-string: true
                        required:
                          - limit
                          - percentage
                    type: object
            targetRef:
              description: |-
                TargetRef is a reference to the resource that represents a group of
                destinations.
              type: object
              properties:
                kind:
                  description: Kind of the referenced resource
                  type: string
                  enum:
                    - Mesh
                    - MeshSubset
                    - MeshGateway
                    - MeshService
                    - MeshExternalService
                    - MeshMultiZoneService
                    - MeshServiceSubset
                    - MeshHTTPRoute
                    - Dataplane
                labels:
                  description: |-
                    Labels are used to select group of MeshServices that match labels. Either Labels or
                    Name and Namespace can be used.
                  type: object
                  additionalProperties:
                    type: string
                mesh:
                  description: Mesh is reserved for future use to identify cross mesh resources.
                  type: string
                name:
                  description: |-
                    Name of the referenced resource. Can only be used with kinds: `MeshService`,
                    `MeshServiceSubset` and `MeshGatewayRoute`
                  type: string
                namespace:
                  description: |-
                    Namespace specifies the namespace of target resource. If empty only resources in policy namespace
                    will be targeted.
                  type: string
                proxyTypes:
                  description: |-
                    ProxyTypes specifies the data plane types that are subject to the policy. When not specified,
                    all data plane types are targeted by the policy.
                  type: array
                  items:
                    enum:
                      - Sidecar
                      - Gateway
                    type: string
                sectionName:
                  description: |-
                    SectionName is used to target specific section of resource.
                    For example, you can target port from MeshService.ports[] by its name. Only traffic to this port will be affected.
                  type: string
                tags:
                  description: |-
                    Tags used to select a subset of proxies by tags. Can only be used with kinds
                    `MeshSubset` and `MeshServiceSubset`
                  type: object
                  additionalProperties:
                    type: string
              required:
                - kind
          required:
            - targetRef
          type: object
          default:
            targetRef:
              kind: MeshService
            default:
              http: []
  creationTime:
    description: Time at which the resource was created
    type: string
    format: date-time
    example: '0001-01-01T00:00:00Z'
    readOnly: true
  modificationTime:
    description: Time at which the resource was updated
    type: string
    format: date-time
    example: '0001-01-01T00:00:00Z'
    readOnly: true
required:
  - type
  - name
  - spec
x-request: true
